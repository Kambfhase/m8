/*!
 * m8 - JavaScript Math Library - v0.3
 * by Kambfhase
 * released under MIT License 
 *
 * includes vice-versa by Andrea Giammarchi
 */
 (function(b,c){var a=(function(){function d(h,i,f){for(var g in h){i.call(f,h[g],g,h)}}for(var e in {toString:null}){if(e==="toString"){return d}}return(function(){for(var g="constructor.hasOwnProperty.isPrototypeOf.propertyIsEnumerable.toLocaleString.toString.valueOf".split("."),h=[],f=g.length;f--;){h[f]=['hasOwnProperty.call(o,"','")&&callback.call(self,o.',',"','",o);'].join(g[f])}return Function("hasOwnProperty",d+";return function(o,callback,self){forIn(o,callback,self);"+h.join("")+"};")(c)})()})();if(!b.defineProperty){b.defineProperty=(function(){function e(g,f){if(c.call(g,"value")){this[f]=g.value}else{if(c.call(g,"get")){this.__defineGetter__(f,g.get)}if(c.call(g,"set")){this.__defineSetter__(f,g.set)}}}function d(h,f,g){if(c.call(g,"value")){h[f]=g.value}else{if(c.call(g,"get")){h.__defineGetter__(f,g.get)}if(c.call(g,"set")){h.__defineSetter__(f,g.set)}}return h}return d})()}if(!b.defineProperties){b.defineProperties=(function(){function e(g,f){b.defineProperty(this,f,g)}function d(f,g){a(g,e,f);return f}return d})()}if(!b.create){b.create=(function(){function e(){}function d(f,g){f=new e(e.prototype=f);e.prototype=null;return g?b.defineProperties(f,g):f}return d})()}if(typeof b.keys!=="function"){b.keys=function(d){var e=[],f;for(f in d){if(c.call(d,f)){e.push(f)}}return e}}if(!b.getPrototypeOf){b.getPrototypeOf=(function(){function d(e){return e.__proto__}return{}.__proto__===b.prototype?d:function(e){if(e instanceof b&&e instanceof e.constructor){return e.constructor.prototype}}})()}if(!b.getOwnPropertyDescriptor){b.getOwnPropertyDescriptor=function(e,d){if(d in e){return{value:e[d]}}}}if(!b.getOwnPropertyNames){b.getOwnPropertyNames=b.keys}})(Object,Object.prototype.hasOwnProperty);var Class=(function(b){var a,c=b.getOwnPropertyNames(function(){});c.push("prototype");a=function(k){var d=function(){return d.create.apply(d,arguments)},h,e,l,g=k.parent,f=k["static"],j=k.instance;if(g){h=b.getOwnPropertyNames(g);e=h.length;while(e--){l=h[e];if(c.indexOf(l)==-1){d=b.defineProperty(d,l,b.getOwnPropertyDescriptor(g,l))}}}if(f){d=b.defineProperties(d,f)}d.prototype=b.create((g&&g.prototype||b.prototype),j);d.prototype=b.defineProperty(d.prototype,"constructor",{value:d,enumerable:false,configurable:true,writable:true});if(!d.create){d.create=function(){return b.create(this.prototype)}}if(!d.is){d.is=function(i){return this.prototype.isPrototypeOf(i)}}return d};a=a({"static":{create:{value:a,enumerable:false,configurable:true,writable:true}}});return a})(Object);var Collection=(function(){var a=Class({parent:Array,"static":{create:{value:function(b){var d=Object.create(this.prototype),c=b.length;while(c--){d[c]=b[c]}return d},configurable:true,writable:true,enumerable:false}},instance:{length:{value:0,configurable:true,writable:true,enumerable:false},toArray:{value:function(){return this.slice()},configurable:true,writable:true,enumerable:false},toString:{value:function(){return this.slice().toString()},configurable:true,writable:true,enumerable:false},}});a.prototype=(function(b){return Object.defineProperty(b,"length",{get:function(){return Object.keys(this).length},set:function(c){if(c>=this.length){this[c]=undefined}}})})(a.prototype);return a})();var Matrix=Class({parent:Collection,"static":{create:{value:function(d,a,e){return this.wrap(a?this.rectangle(d,a,e):d)},enumerable:false,configurable:true,writable:true},wrap:{value:function(a){var c=Object.create(this.prototype),b=a.length;while(b--){c[b]=a[b].slice()}return c},enumerable:false,configurable:true,writable:true},rectangle:{value:function(b,g,d){var f,e=b,c=g,a=[];d=d===undefined?0:d;while(e--){f=[];c=g;while(c--){f[c]=d}a[e]=f}return a},enumerable:false,configurable:true,writable:true},deepArrayCopy:{value:function(a){if(Array.prototype.isPrototypeOf(a)||a.map){return a.map(this.deepArrayCopy,this)}else{return a}},enumerable:false,configurable:true,writable:true},sameDimensions:{value:function(){var b=arguments.length-1,c=arguments[b].length,a=arguments[b][0].length;while(b--){if(c!==arguments[b].length||a!==arguments[b][0].length){return false}}return true},enumerable:false,configurable:true,writable:true},precision:{value:0.000001,enumerable:false,configurable:true,writable:true},like:{value:function(a){return this.isRectangular(a)},enumerable:false,configurable:true,writable:true},isRectangular:{value:function(a){if(!a||!a.length||!a[0].length){return false}var b=1,c=a[0].length;for(;b<a.length;++b){if(a[b].length!==c){return false}}return true},enumerable:false,configurable:true,writable:true},isSquare:{value:function(a){return a.length===a[0].length&&this.isRectangular(a)},enumerable:false,configurable:true,writable:true},isTriangular:{value:function(b){var a=b.length,g=b[0].length,d,e,c,f;e=a;while(e--){d=g;f=b[e];while(d--){if(e===d||!f[d]){continue}if(!c){c=(e>d?-1:1);continue}if(c===(e>d?-1:1)){continue}return 0}}return c||2},enumerable:false,configurable:true,writable:true},identity:{value:function(d){var a=[],c=0,b;for(;c<d;++c){a[c]=[];for(b=0;b<d;++b){a[c][b]=c===b?1:0}}return this.wrap(a)},enumerable:false,configurable:true,writable:true},householder:{value:function(a){var c=Vector(a).normalize(),b=c.length;return Matrix.identity(b).add(c.mult(c.transpose()).scale(-2))},enumerable:false,configurable:true,writable:true},det:{value:function(b){var d=0,a=b.length,f=b[0].length,e=f,c;if(a===1){return b[0][0]}if(a===2){return b[0][0]*b[1][1]-b[0][1]*b[1][0]}if(!!Matrix.isTriangular(b)){d=1;while(e--){d*=b[e][e]}return d}else{c=b[0];while(e--){if(c[e]){d+=c[e]*(e&1?-1:1)*Matrix.det(Matrix.cut(b,0,e))}}return d}},enumerable:false,configurable:true,writable:true},cut:{value:function(a,d,c){var b=a.slice(0,d).concat(a.slice(d+1));b=b.map(function(e){return e.slice(0,c).concat(e.slice(c+1))});return b},enumerable:false,configurable:true,writable:true}},instance:{copy:{value:function(){return this.constructor.create(Matrix.deepArrayCopy(this))},enumerable:false,configurable:true,writable:true},toArray:{value:function(){return this.slice()},enumerable:false,configurable:true,writable:true},toString:{value:function(){return JSON.stringify(this.toArray())},enumerable:false,configurable:true,writable:true},transpose:{value:function(){var b,c=this[0].length,a=this.length,d=[];while(c--){b=a;d[c]=[];while(b--){d[c][b]=this[b][c]}}return this.constructor.create(d)},enumerable:false,configurable:true,writable:true},scale:{value:function(a){var d=[],c=this.length,b,e;while(c--){e=[];b=this[c].length;while(b--){e[b]=this[c][b]*a}d[c]=e}return this.constructor.create(d)},enumerable:false,configurable:true,writable:true},add:{value:function(a){if(!Matrix.sameDimensions(this,a)){throw new TypeError("this.add( other): Only Matrices of the same Dimensions kann be added. this: "+this.toString()+" other: "+Matrix.prototype.toString.call(a))}var d=[],c=this.length,b,e;while(c--){e=[];b=this[c].length;while(b--){e[b]=this[c][b]+a[c][b]}d[c]=e}return this.constructor.create(d)},enumerable:false,configurable:true,writable:true},multWMatrix:{value:function(p){if(this[0].length!==p.length){throw new TypeError("this.mult( other): The matrices dimensions mismatch! this: "+this.toString()+" other: "+p)}var l=[],g=0,e,d,b=this.length,c=p[0].length,a=p.length,h,q,f;if(a===1){for(;g<b;g++){q=this[g];for(e=0;e<c;++e){f=[q[0]*p[0][e]]}l[g]=f}return this.constructor.create(l)}if(a===2){g=b;while(g--){f=[];q=this[g];e=c;while(e--){f[e]=q[0]*p[0][e]+q[1]*p[1][e]}l[g]=f}return this.constructor.create(l)}for(;g<b;++g){f=[];q=this[g];for(e=0;e<c;++e){h=0;for(d=0;d<a;++d){h+=q[d]*p[d][e]}f[e]=h}l[g]=f}return this.constructor.create(l)},enumerable:false,configurable:true,writable:true},multWVector:{value:function(a){var b=a.constructor;return b(this.multWMatrix(a.toMatrix()).map(function(c){return c[0]}))},enumerable:false,configurable:true,writable:true},mult:{value:function(a){if(typeof a==="number"){return this.scale(a)}else{if(Matrix.is(a)||Matrix.like(a)){return this.multWMatrix(a)}else{if(Vector.is(a)){return this.multWVector(a)}else{if(a.toMatrix){return this.multWMatrix(a.toMatrix())}}}}},enumerable:false,configurable:true,writable:true},pow:{value:function(d){d=~~d;var f=this.length;if(!d){return Matrix.identity(f)}if(d===1){return this.copy()}var b=this,a=2,c=d&1?this:Matrix.identity(f);while(a<=d){b=b.mult(b);if(a&d){c=c.mult(b)}a<<=1}return c},enumerable:false,configurable:true,writable:true},adjugate:{value:function(){if(!Matrix.isSquare(this)){throw new TypeError("this.adjugate(): there is no adjugate matrix for non square matrixes. this:"+this.toString())}if(this.length===1){return this.copy()}var a=[],e=this[0].length,c=e,b,d;while(c--){d=[];b=e;while(b--){d[b]=((c^b)&1?-1:1)*Matrix.prototype.det.call(Matrix.cut(this,b,c))}a[c]=d}return Matrix.wrap(a)},enumerable:false,configurable:true,writable:true},invert:{value:function(){if(!Matrix.isSquare(this)){throw new TypeError("this.invert(): there is no inverted matrix for non square matrixes. this:"+this.toString())}if(this.length===1){return Matrix.create([[1/this[0][0]]])}return this.adjugate().scale(1/this.det())},enumerable:false,configurable:true,writable:true},row:{value:function(a){return this[a]},enumerable:false,configurable:true,writable:true},col:{value:function(a){var c=[],b=0;for(;b<this.length;b++){c[b]=this[b][a]}return c},enumerable:false,configurable:true,writable:true},det:{value:function(){if(!Matrix.isSquare(this)){return null}var a=this.length,h=1;if(a===1){return this[0][0]}if(a===2){return this[0][0]*this[1][1]-this[1][0]*this[0][1]}if(Matrix.isTriangular(this)){while(a--){h*=this[a][a]}return h}else{var g,d,b,l,f,c,e=Matrix.deepArrayCopy(this);for(g=0;g<a;g++){f=e[g];if(!f[g]){for(d=g+1;d<a;d++){c=e[d];if(c[g]){for(b=g;b<a;b++){f[b]+=c[b]}break}}}if(f[g]){for(d=g+1;d<a;d++){c=e[d];l=c[g]/f[g];if(l){for(b=g;b<a;b++){c[b]-=f[b]*l}}}h*=f[g]}else{return 0}}return h}},enumerable:false,configurable:true,writable:true},equals:{value:function(a){if(!Matrix.sameDimensions(this,a)){return false}var d=this.length,c,b,e;while(d--){b=this[d];e=a[d];c=b.length;while(c--){if(Math.abs(b[c]-e[c])>Matrix.precision){return false}}}return true},enumerable:false,configurable:true,writable:true}}});var Vector=Class.create({parent:Collection,"static":{like:{value:function(a){if((Array.prototype.isPrototypeOf(a)||"length" in a)&&typeof a[0]==="number"){return true}else{return false}},enumerable:false,configurable:true,writable:true},sameDimensions:{value:function(){var b=arguments.length,a=arguments[--b].length;while(b--){if(arguments[b].length!==a){return false}}return true},enumerable:false,configurable:true,writable:true},standardScalarproduct:{value:function(d,c){if(!this.sameDimensions(d,c)){throw new TypeError("Vector-Dimensions mismatch!")}var e=0,f=d.length;while(f--){e+=d[f]*c[f]}return e},enumerable:false,configurable:true,writable:true},precision:{value:0.000001,enumerable:false,configurable:true,writable:true}},instance:{sameDimensions:{value:function(a){if(arguments.length===1){return this.length===a.length}else{return this.constructor.sameDimensions.apply(this.constructor,arguments.push(this))}},enumerable:false,configurable:true,writable:true},toArray:{value:function(){return this.slice()},enumerable:false,configurable:true,writable:true},copy:{value:function(){return this.constructor.create(this.slice())},enumerable:false,configurable:true,writable:true},toMatrix:{value:function(){var b=[],a=this.length;while(a--){b[a]=[this[a]]}return Matrix.create(b)},enumerable:false,configurable:true,writable:true},magnitude:{value:function(){var a=0,b=this.length;while(b--){a+=this[b]*this[b]}return Math.sqrt(a)},enumerable:false,configurable:true,writable:true},equals:{value:function(a,b){b=b===undefined?this.constructor.precision:b;if(!this.sameDimensions(a)){return false}var c=this.length;while(c--){if(Math.abs(this[c]-a[c])>b){return false}}return true},enumerable:false,configurable:true,writable:true},scale:{value:function(a){var c=[],b=this.length;while(b--){c[b]=this[b]*a}return this.constructor.create(c)},enumerable:false,configurable:true,writable:true},normalize:{value:function(){return this.scale(1/this.magnitude())},enumerable:false,configurable:true,writable:true},add:{value:function(a){var c=[],b=this.length;if(!this.sameDimensions(a)){throw new TypeError("Vector-Dimensions mismatch")}while(b--){c[b]=this[b]+a[b]}return this.constructor.create(c)},enumerable:false,configurable:true,writable:true},dot:{value:function(a){if(!this.sameDimensions(a)){throw new TypeError("Vector-Dimension mismatch")}var b=0,c=this.length;while(c--){b+=this[c]*a[c]}return b},enumerable:false,configurable:true,writable:true},multWhVector:{value:function(a){var f=this.length,c=f,b,d=[],e;while(c--){b=f;e=[];while(b--){e[b]=this[c]*a[b]}d[c]=e}return Matrix.create(d)},enumerable:false,configurable:true,writable:true},mult:{value:function(a){var b=this.constructor;if(typeof a==="number"){return this.scale(a)}else{if(hVector.is(a)||hVector.like(a)){return this.multWhVector(a)}else{if(b.is(a)||b.like(a)){return this.dot(a)}}}},enumerable:false,configurable:true,writable:true}}}),hVector=Class({parent:Vector,"static":{like:{value:function(a){return Vector.like(a)&&a.horizontal}}},instance:{horizontal:{value:true,enumerable:false,configurable:true,writable:true},toMatrix:{value:function(){return Matrix.create(this.slice())},enumerable:false,configurable:true,writable:true},multWhVector:{value:function(a){return this.dot(a)},enumerable:false,configurable:true,writable:true},multWMatrix:{value:function(f){var e=this.length;if(e!==f.length){throw"Dimension mismatch!"}var d=[],b=e,a,c;while(b--){c=0;a=e;while(a--){c+=this[b]*f[a][b]}d[b]=c}return this.constructor(d)},enumerable:false,configurable:true,writable:true},multWVector:{value:function(a){return this.dot(a)},enumerable:false,configurable:true,writable:true},mult:{value:function(a){var b=this.constructor;if(typeof a==="number"){return this.scale(a)}else{if(Matrix.is(a)){return this.multWMatrix(a)}else{if(b.is(a)||b.like(a)){return this.dot(a)}else{if(hVector.is(a)||hVector.like(a)){return this.multWVector(a)}}}}},enumerable:false,configurable:true,writable:true}}});var binom=function(c,a){var b=1;if(a>(c/2)){a=c-a}while(a){b*=c+1-a;b/=a;a--}return b};var fibonacci=(function(a){var c=(1+a.sqrt(5))/2,b=(1-a.sqrt(5))/2;return function(d){return d<=2?d&&1:a.round((a.pow(c,d)-a.pow(b,d))/a.sqrt(5))}})(Math);var factorial=function(b){if(b<2){return 1}var a=1;while(b){a*=b--}return a};var Complex=Class({parent:Number,"static":{create:{value:function(c,a){var b=Object.create(this.prototype);b.r=c||0;b.i=a||0;return b},enumerable:false,configurable:true,writable:true},precision:{value:0.000001,enumerable:false,configurable:true,writable:true},zero:{value:function(){return this.create(0,0)},enumerable:false,configurable:true,writable:true},one:{value:function(){return this.create(1,0)},enumerable:false,configurable:true,writable:true}},instance:{copy:{value:function(){return this.constructor.create(this.r,this.i)},enumerable:false,configurable:true,writable:true},valueOf:{value:function(){return this.r},enumerable:false,configurable:true,writable:true},toString:{value:function(){return this.r+(this.i<0?""+this.i:"+"+this.i)+"i"},enumerable:false,configurable:true,writable:true},equals:{value:function(a){return Math.abs(this.r-a.r)<this.constructor.precision&&Math.abs(this.i-a.i)<this.constructor.precision},enumerable:false,configurable:true,writable:true},conjugate:{value:function(){return this.constructor.create(this.r,-this.i)},enumerable:false,configurable:true,writable:true},add:{value:function(a){return this.constructor.create(this.r+a.r,this.i+a.i)},enumerable:false,configurable:true,writable:true},sub:{value:function(a){return this.constructor.create(this.r-a.r,this.i-a.i)},enumerable:false,configurable:true,writable:true},mult:{value:function(a){if(typeof a=="number"){return this.constructor.create(a*this.r,a*this.i)}else{return this.constructor.create(this.r*a.r-this.i*a.i,this.r*a.i+this.i*a.r)}},enumerable:false,configurable:true,writable:true},div:{value:function(a){var b=1/(a.r*a.r+a.i*a.i);return this.constructor.create((this.r*a.r+this.i*a.i)*b,(this.i*a.r-this.r*a.i)*b)},enumerable:false,configurable:true,writable:true}}});function gMatrix(b){var a=Class.create({parent:gMatrix.parent,"static":{_koerper:{value:b,enumerable:false,configurable:true,writable:true}}});return a}gMatrix.parent=Class({parent:Collection,"static":{_koerper:{value:null,enumerable:false,configurable:true,writable:true},create:{value:function(a){var d=Object.create(this.prototype),c=a.length,f=a[0].length,b,e;while(c--){e=[];b=f;while(b--){e[b]=this._koerper(a[c][b])}d[c]=e}return d},enumerable:false,configurable:true,writable:true},identity:{value:function gMatrix_identity(g){var c=g,a,e=[],f,b=this._koerper.one,d=this._koerper.zero;while(c--){a=g;f=[];while(a--){f[a]=c==a?this._koerper.one():this._koerper.zero()}e[c]=f}return this.create(e)},enumerable:false,configurable:true,writable:true}},instance:{scale:{value:function(c){var g=[],e=this.length,d,a=this[0].length,b,f;while(e--){b=this[e];f=[];d=a;while(d--){f[d]=b[d].mult(c)}g[e]=f}return this.constructor.create(g)},enumerable:false,configurable:true,writable:true},add:{value:function(g){if(this.length!==g.length||this[0].length!==g[0].length){throw"dimensions mismatch!"}var a=this.length,b=this[0].length,e=a,c,f=[],d,h,k;while(e--){h=this[e];k=g[e];d=[];c=b;while(c--){d[c]=h[c].add(k[c])}f[e]=d}return this.constructor.create(f)},enumerable:false,configurable:true,writable:true},multWMatrix:{value:function(p){if(this[0].length!==p.length){throw"dimensions mismatch!"}var b=this.length,c=p[0].length,a=p.length,g=b,e,d,l,f,q,h;while(g--){q=this[g];f=[];e=c;while(e--){d=a;h=q[0].mult(p[0][e]);while(--d){h=h.add(q[d].mult(p[d][e]))}}l[g]=f}},enumerable:false,configurable:true,writable:true},transpose:{value:function(){var f=this.length,a=this[0].length,c=f,b,e=[],d;while(c--){d=[];b=a;while(b--){d[b]=this[b][c]}e[c]=d}return this.constructor.create(e)},enumerable:false,configurable:true,writable:true}}});